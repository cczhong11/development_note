<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Filesystem - my_note</title>
  

  <link
    rel="shortcut icon"
    href="https://notes.tczhong.com/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://notes.tczhong.com/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://notes.tczhong.com/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://notes.tczhong.com/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
  
<meta name="description" content="Personal knowledge space">
<meta name="author" content="">

<link rel="canonical" href="https://notes.tczhong.com/notes/1f47041a-df34-437a-9e59-c4ed0fd44232.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://notes.tczhong.com/notes/1f47041a-df34-437a-9e59-c4ed0fd44232.html">
<meta property="og:description" content="Personal knowledge space">
<meta property="og:image" content="https://notes.tczhong.comundefined">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://notes.tczhong.com/notes/1f47041a-df34-437a-9e59-c4ed0fd44232.html">
<meta name="twitter:description" content="Personal knowledge space">
<meta name="twitter:image" content="https://notes.tczhong.comundefined">


  <meta property="og:title" content="Filesystem - my_note" />
  <meta name="twitter:title" content="Filesystem - my_note" />
  
</head>


<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://notes.tczhong.com" class="site-title lh-tight">
  my_note

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ğŸŒ± with ğŸ’• using <a href="https://www.dendron.so/"> Dendron ğŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search my_note" aria-label="Search my_note" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://notes.tczhong.com">Development</a></li><li class="breadcrumb-nav-list-item"><a href="https://notes.tczhong.com/notes/a40ef849-d301-4d74-a778-e6d9469dfb5d.html">Database</a></li><li class="breadcrumb-nav-list-item"><a href="https://notes.tczhong.com/notes/00876989-d1a6-423c-96c5-efc3b87de2b4.html">Distributed_system</a></li><li class="breadcrumb-nav-list-item">Filesystem</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Filesystem">
    
    <meta itemprop="datePublished" content="2021-04-12T19:59:15+00:00">
    <meta itemprop="dateModified" content="2021-04-12T20:00:37+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="filesystem"><a aria-hidden="true" class="anchor-heading" href="#filesystem"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Filesystem</h1>
<h1 id="file-system"><a aria-hidden="true" class="anchor-heading" href="#file-system"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>file system</h1>
<ul>
<li><strong>what</strong>: a file is a unit of data organized by user. a service responsible for managing files</li>
<li><strong>why</strong>: key is robust and high-throughput</li>
<li><strong>how</strong>: name, access, physical allocation, security and protection, resource administration.</li>
</ul>
<h2 id="nfs-and-afs"><a aria-hidden="true" class="anchor-heading" href="#nfs-and-afs"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>NFS and AFS</h2>
<ol>
<li>NFS has no client caching, cliented cached anyway, central system</li>
<li>AFS is stateful server and has cache protocol. called to have data client there is an update, their cache is invalid. Whole file semantic</li>
<li>CODA, add replication and added weakly connected mode.</li>
</ol>
<h1 id="raids-and-hdfs"><a aria-hidden="true" class="anchor-heading" href="#raids-and-hdfs"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>RAIDS and HDFS</h1>
<h2 id="normal-disk"><a aria-hidden="true" class="anchor-heading" href="#normal-disk"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Normal disk</h2>
<ul>
<li>An error-correcting code (ECC) or forward error correction (FEC) code is a process of adding <strong>redundant</strong> data, or parity data, to a message, such that it can be recovered by a receiver even when a number of errors (up to the capability of the code being used) were introduced, either during the process of transmission, or on storage.</li>
<li>RAM could cache the data. It will only read data from disks. If there was error, disk will return nothing.</li>
</ul>
<h2 id="raids"><a aria-hidden="true" class="anchor-heading" href="#raids"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>RAIDS</h2>
<ul>
<li><strong>what</strong>:Redundant Array of Independent Disks,combines multiple physical disk drive components into one or more logical units for the purposes of data redundancy, performance improvement, or both.</li>
<li><strong>why</strong>: more rebust, larger volume,higher throughput</li>
<li><strong>how</strong>:
<ul>
<li>RAID 0 å®ƒå°‡å…©ä¸ªä»¥ä¸Šçš„ç£ç›˜ä¸¦è”èµ·æ¥ï¼Œ<strong>æˆä¸ºä¸€ä¸ªå¤§å®¹é‡çš„ç£ç›˜</strong>ã€‚åœ¨å­˜æ”¾æ•°æ®æ—¶ï¼Œåˆ†æ®µååˆ†æ•£å„²å­˜åœ¨è¿™äº›ç£ç›˜ä¸­ï¼Œå› ç‚ºè¯»å†™æ™‚éƒ½å¯ä»¥å¹¶è¡Œè™•ç†ï¼Œæ‰€ä»¥åœ¨æ‰€æœ‰çš„çº§åˆ«ä¸­ï¼ŒRAID 0çš„<strong>é€Ÿåº¦</strong>æ˜¯æœ€å¿«çš„ã€‚no redundancy,just split into serveral disks</li>
<li>RAID 1: mirroring,disk0=disk1,åœ¨ä¸€äº›å¤šçº¿ç¨‹æ“ä½œç³»ç»Ÿä¸­èƒ½æœ‰å¾ˆå¥½çš„<strong>è¯»å–</strong>é€Ÿåº¦,replicationï¼Œç†è«–ä¸Šè¯»å–é€Ÿåº¦ç­‰æ–¼ç¡¬ç›˜æ•¸é‡çš„å€æ•¸ï¼Œä¸RAID 0ç›¸åŒ</li>
<li>RAID 2:è¿™æ˜¯RAID 0çš„æ”¹è‰¯ç‰ˆï¼Œä»¥æ±‰æ˜ç ï¼ˆHamming Codeï¼‰çš„æ–¹å¼å°†æ•°æ®è¿›è¡Œç¼–ç ååˆ†å‰²ä¸ºç‹¬ç«‹çš„ä½å…ƒï¼Œå¹¶å°†æ•°æ®åˆ†åˆ«å†™å…¥ç¡¬ç›˜ä¸­ã€‚å› ä¸ºåœ¨æ•°æ®ä¸­åŠ å…¥äº†é”™è¯¯ä¿®æ­£ç ï¼ˆECCï¼ŒError Correction Codeï¼‰ï¼Œæ‰€ä»¥æ•°æ®æ•´ä½“çš„å®¹é‡ä¼šæ¯”åŸå§‹æ•°æ®å¤§ä¸€äº›. log2. Have disks save error correction code for each partition.</li>
<li>RAID3: a disk save <strong>parity</strong>. æ¡ç”¨Bitï¼interleavingï¼ˆæ•°æ®äº¤é”™å„²å­˜ï¼‰æŠ€è¡“ï¼Œå®ƒéœ€è¦é€šè¿‡ç¼–ç å†å°†æ•°æ®ä½å…ƒåˆ†å‰²å¾Œåˆ†åˆ«å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œè€Œå°†åŒä½å…ƒæ£€æŸ¥å¾Œå•ç‹¬å­˜åœ¨ä¸€ä¸ªç¡¬ç›˜ä¸­ï¼Œä½†ç”±äºæ•°æ®å†…çš„ä½å…ƒåˆ†æ•£åœ¨ä¸åŒçš„ç¡¬ç›˜ä¸Šï¼Œå› æ­¤å°±ç®—è¦è¯»å–ä¸€å°æ®µæ•°æ®èµ„æ–™éƒ½å¯èƒ½éœ€è¦æ‰€æœ‰çš„ç¡¬ç›˜è¿›è¡Œå·¥ä½œï¼Œæ‰€ä»¥è¿™ç§è§„æ ¼æ¯”è¾ƒé€‚äºè¯»å–å¤§é‡æ•°æ®æ—¶ä½¿ç”¨ã€‚</li>
<li>RAID4:å®ƒä¸RAID 3ä¸åŒçš„æ˜¯å®ƒåœ¨åˆ†å‰²æ—¶æ˜¯ä»¥blockä¸ºå•ä½åˆ†åˆ«å­˜åœ¨ç¡¬ç›˜ä¸­</li>
<li>RAID5:RAID Level 5æ˜¯ä¸€ç§å‚¨å­˜æ€§èƒ½ã€æ•°æ®å®‰å…¨å’Œå­˜å‚¨æˆæœ¬å…¼é¡¾çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚å®ƒä½¿ç”¨çš„æ˜¯Disk Stripingï¼ˆç¡¬ç›˜åˆ†å‰²ï¼‰æŠ€æœ¯ã€‚RAID 5è‡³å°‘éœ€è¦ä¸‰å—ç¡¬ç¢Ÿï¼ŒRAID 5ä¸æ˜¯å¯¹å­˜å‚¨çš„æ•°æ®è¿›è¡Œå¤‡ä»½ï¼Œè€Œæ˜¯æŠŠæ•°æ®å’Œç›¸å¯¹åº”çš„å¥‡å¶æ ¡éªŒä¿¡æ¯å­˜å‚¨åˆ°ç»„æˆRAID5çš„å„ä¸ªç£ç›˜ä¸Šï¼Œå¹¶ä¸”å¥‡å¶æ ¡éªŒä¿¡æ¯å’Œç›¸å¯¹åº”çš„æ•°æ®åˆ†åˆ«å­˜å‚¨æ–¼ä¸åŒçš„ç£ç›˜ä¸Šã€‚<strong>å½“RAID5çš„ä¸€ä¸ªç£ç›˜æ•°æ®å‘ç”ŸæŸåå¾Œï¼Œå¯ä»¥åˆ©ç”¨å‰©ä¸‹çš„æ•°æ®å’Œç›¸åº”çš„å¥‡å¶æ ¡éªŒä¿¡æ¯å»æ¢å¤è¢«æŸåçš„æ•°æ®</strong>ã€‚<img src="https://en.wikipedia.org/wiki/File:RAID_5.svg"></li>
<li>RAID6:ä¸RAID 5ç›¸æ¯”ï¼ŒRAID 6å¢åŠ ç¬¬äºŒä¸ªç‹¬ç«‹çš„å¥‡å¶æ ¡éªŒä¿¡æ¯å—</li>
<li>RAID10 = RAID0+RAID1</li>
</ul>
</li>
</ul>
<h2 id="lustre"><a aria-hidden="true" class="anchor-heading" href="#lustre"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>LUSTRE</h2>
<ul>
<li><strong>what</strong>:a type of parallel distributed file system, generally used for large-scale cluster computing</li>
<li><strong>why</strong>: used for supercomputing, network RAID</li>
<li><strong>how</strong>:
<ul>
<li>Files are broken into objects, very similar to stripes. These stripes can be stored by different nodes.</li>
<li>One or more metadata servers (MDS) nodes that has one or more metadata target (MDT) devices per Lustre filesystem that stores namespace metadata, such as filenames, directories, access permissions, and file layout(different access pattern,data is small)</li>
<li>One or more object storage server (OSS) nodes that store file data on one or more object storage target (OST) devices.(enable either OSS talk to either OST)</li>
<li>Client(s) that access and use the data. Lustre presents all clients with a unified namespace for all of the files and data in the filesystem</li>
<li>high performance network to transfer data and manage network to manage data</li>
</ul>
</li>
</ul>
<h2 id="mogilefs"><a aria-hidden="true" class="anchor-heading" href="#mogilefs"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>MOGILEFS</h2>
<ul>
<li><strong>what</strong>:distributed filesystem</li>
<li><strong>why</strong>:no editing, whole file,fast deliver to clients</li>
<li><strong>how</strong>:
<ul>
<li>replicated storage:it replicates objects across servers. The number of replicas is associated with the class of the file, so, for example, photos might have three replicas, each, but thumbnails, which can be recreated from the original photos, might only have one replica of each. this reduces the cost of the storage by allowing less expensive components.</li>
<li>http+MySQL:MogileFS uses HTTP to server objects from each replica, as opposed to a home-grown protocol, for portability. For the same reason, it keeps its metadata in a standard MySQL database. </li>
<li>portable</li>
<li>no hierachy: it maintains simple namespaces, rather than directory trees,  is much simpler and more efficient than a full-blown directory system</li>
</ul>
</li>
</ul>
<h2 id="hdfs"><a aria-hidden="true" class="anchor-heading" href="#hdfs"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>HDFS</h2>
<h3 id="assumption"><a aria-hidden="true" class="anchor-heading" href="#assumption"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>assumption</h3>
<ul>
<li>failure is a norm, especially on datanode. It is used to handle streaming data. </li>
<li>emphasis is on throughput not on latency</li>
<li>large data sets</li>
<li>simple coherency model: write once and read many</li>
<li>moving computation is cheaper than moving data</li>
<li>The good news is that it won't be edited in place. We'll just be collecting it, adding to it.</li>
<li><img src="/assets/images/2021-04-12-19-59-50.png"></li>
</ul>
<h2 id="namenode"><a aria-hidden="true" class="anchor-heading" href="#namenode"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>namenode</h2>
<ul>
<li><strong>what</strong>: master-slave architecture</li>
<li><strong>why</strong>: manage namespace as coordinator, only 1</li>
<li><strong>how</strong>: block to DataNodes mapping</li>
<li>data never go to namenode</li>
<li>hierarchical name space: maybe not needed, low overhead</li>
</ul>
<h2 id="datanode"><a aria-hidden="true" class="anchor-heading" href="#datanode"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>datanode</h2>
<ul>
<li>manage storage attached to node</li>
<li>create and delete block, replicate blocks</li>
</ul>
<h2 id="access-mode"><a aria-hidden="true" class="anchor-heading" href="#access-mode"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>access mode</h2>
<ul>
<li>read anywhere</li>
<li>write only at end(append)</li>
<li>no edit/random write</li>
</ul>
<h2 id="replication"><a aria-hidden="true" class="anchor-heading" href="#replication"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>replication</h2>
<ul>
<li>blocks are all same size</li>
<li>fault tolerance</li>
<li>namenode managed replication</li>
<li>pipelining
<ul>
<li>When a client is writing data to an HDFS file, its data is first written to a local file as explained in the previous section.</li>
<li>The <strong>first</strong> DataNode starts receiving the data in small portions (4 KB), writes each portion to its local repository and transfers that portion to the <strong>second</strong> DataNode in the list. The second DataNode, in turn starts receiving each portion of the data block, writes that portion to its repository and then flushes that portion to the <strong>third</strong> DataNode.</li>
<li>less bandwidth and less hot-spot</li>
</ul>
</li>
</ul><span id="navId" data="1f47041a-df34-437a-9e59-c4ed0fd44232"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>


        
          <hr>
          <footer>
            
            

            
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>
</body>
</html>
