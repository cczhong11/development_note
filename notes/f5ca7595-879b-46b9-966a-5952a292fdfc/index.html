<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Loadbalance</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="Loadbalance"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://notes.tczhong.com/notes/f5ca7595-879b-46b9-966a-5952a292fdfc/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/24/2021"/><meta property="article:modified_time" content="5/4/2021"/><link rel="canonical" href="https://notes.tczhong.com/notes/f5ca7595-879b-46b9-966a-5952a292fdfc/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/55969ab92b38e37f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/55969ab92b38e37f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-8e0b6832cc385016.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-c4b0e551a2150d17.js" defer=""></script><script src="/_next/static/chunks/pages/_app-274947796022cf6e.js" defer=""></script><script src="/_next/static/chunks/155-3a6c02d7e042edb7.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-dc9b1cbe134a7143.js" defer=""></script><script src="/_next/static/BJJu79SH0O6jPLyBmlOdc/_buildManifest.js" defer=""></script><script src="/_next/static/BJJu79SH0O6jPLyBmlOdc/_ssgManifest.js" defer=""></script><script src="/_next/static/BJJu79SH0O6jPLyBmlOdc/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout" style="flex-direction:row"><section class="ant-layout site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></section><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="loadbalance"><a aria-hidden="true" class="anchor-heading" href="#loadbalance"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Loadbalance</h1>
<h1 id="load-balance"><a aria-hidden="true" class="anchor-heading" href="#load-balance"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>load balance</h1>
<p>把一系列task分给不同的机器。</p>
<ul>
<li>静态
<ul>
<li>it does not take into account the state of the system for the distribution of tasks</li>
<li>are easy to set up and extremely efficient in the case of fairly regular tasks</li>
</ul>
</li>
<li>动态
<ul>
<li>take into account the current load of each of the computing units</li>
<li>tasks can be moved dynamically from an overloaded node to an underloaded node in order to receive faster processing</li>
</ul>
</li>
</ul>
<h2 id="proxy"><a aria-hidden="true" class="anchor-heading" href="#proxy"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>proxy</h2>
<ul>
<li>
<p>Client-side random load balancing: deliver a list of server IPs to the client, and then to have client randomly select the IP from the list on each connection</p>
<ul>
<li>the method of delivery of list of IPs to the client can vary</li>
</ul>
</li>
<li>
<p>Server-side load balancers</p>
<ul>
<li>The load balancer forwards requests to one of the "backend" servers</li>
<li>load balancers are implemented in high-availability pairs which may also replicate session persistence data if required by the specific application</li>
</ul>
</li>
<li>
<p>presistence</p>
<ul>
<li>important issue when operating a load-balanced service is how to handle information that must be kept across the multiple requests in a user's session. </li>
<li>One basic solution to the session data issue is to send all requests in a user session consistently to the same backend server.</li>
<li>Assignment to a particular server might be based on a username, client IP address, or be random.</li>
<li>use memcache to save session info</li>
<li>a simple but efficient approach is to store the per-session data in the browser itself: cookie
<ul>
<li>or URL rewriting</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="forward"><a aria-hidden="true" class="anchor-heading" href="#forward"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>forward</h3>
<p>前向代理作为客户端的代理，将从互联网上获取的资源返回给一个或多个的客户端，服务端（如Web服务器）只知道代理的IP地址而不知道客户端的IP地址
Forward proxies ensure that websites never communicate directly with a user</p>
<p><img src="/assets/images/2021-05-03-22-38-13.png"></p>
<h3 id="reverse"><a aria-hidden="true" class="anchor-heading" href="#reverse"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>reverse</h3>
<p>反向代理是作为服务器端（如Web服务器）的代理使用，而不是客户端。反向代理是供很多客户端都通过它间接访问不同后端服务器上的资源，而不需要知道这些后端服务器的存在，而以为所有资源都来自于这个反向代理服务器。
reverse proxies ensure that users would not communicate directly with a back-end server.
<img src="/assets/images/2021-05-03-22-39-21.png"></p>
<p>A reverse proxy server is a type of proxy server that typically sits behind the firewall in a private network and directs client requests to the appropriate backend server. A reverse proxy provides an additional level of abstraction and control to ensure the smooth flow of network traffic between clients and servers.</p>
<h2 id="dns"><a aria-hidden="true" class="anchor-heading" href="#dns"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>DNS</h2>
<ul>
<li>round-robin DNS: multiple IP addresses are associated with a single domain name</li>
<li><a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)#DNS_delegation">DNS delegation</a>: delegate <a href="http://www.example.org">www.example.org</a> as a sub-domain whose zone is served by each of the same servers that are serving the web site. This technique works particularly well where individual servers are spread geographically on the Internet. </li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#load-balance" title="Load Balance">Load Balance</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#proxy" title="Proxy">Proxy</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#forward" title="Forward">Forward</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#reverse" title="Reverse">Reverse</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dns" title="Dns">Dns</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"f5ca7595-879b-46b9-966a-5952a292fdfc","title":"Loadbalance","vault":{"fsPath":"repos/dendron-aws-vault","remote":{"type":"git","url":"https://github.com/cczhong11/my_note.git"},"name":"my_note"},"type":"note","desc":"","links":[],"anchors":{"load-balance":{"type":"header","value":"load-balance","line":8,"column":0},"proxy":{"type":"header","value":"proxy","line":20,"column":0},"forward":{"type":"header","value":"forward","line":37,"column":0},"reverse":{"type":"header","value":"reverse","line":43,"column":0},"dns":{"type":"header","value":"dns","line":51,"column":0}},"fname":"development.network.loadbalance","updated":1620107065298,"created":1616563104888,"parent":"92917ea3-452e-48dc-875e-5cd0002041db","children":[],"data":{},"custom":{},"contentHash":"05a4a6ee34ac3033b4e04a90667552f7"},"body":"\u003ch1 id=\"loadbalance\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#loadbalance\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eLoadbalance\u003c/h1\u003e\n\u003ch1 id=\"load-balance\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#load-balance\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eload balance\u003c/h1\u003e\n\u003cp\u003e把一系列task分给不同的机器。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e静态\n\u003cul\u003e\n\u003cli\u003eit does not take into account the state of the system for the distribution of tasks\u003c/li\u003e\n\u003cli\u003eare easy to set up and extremely efficient in the case of fairly regular tasks\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e动态\n\u003cul\u003e\n\u003cli\u003etake into account the current load of each of the computing units\u003c/li\u003e\n\u003cli\u003etasks can be moved dynamically from an overloaded node to an underloaded node in order to receive faster processing\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"proxy\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#proxy\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eproxy\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eClient-side random load balancing: deliver a list of server IPs to the client, and then to have client randomly select the IP from the list on each connection\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe method of delivery of list of IPs to the client can vary\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eServer-side load balancers\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe load balancer forwards requests to one of the \"backend\" servers\u003c/li\u003e\n\u003cli\u003eload balancers are implemented in high-availability pairs which may also replicate session persistence data if required by the specific application\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003epresistence\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eimportant issue when operating a load-balanced service is how to handle information that must be kept across the multiple requests in a user's session. \u003c/li\u003e\n\u003cli\u003eOne basic solution to the session data issue is to send all requests in a user session consistently to the same backend server.\u003c/li\u003e\n\u003cli\u003eAssignment to a particular server might be based on a username, client IP address, or be random.\u003c/li\u003e\n\u003cli\u003euse memcache to save session info\u003c/li\u003e\n\u003cli\u003ea simple but efficient approach is to store the per-session data in the browser itself: cookie\n\u003cul\u003e\n\u003cli\u003eor URL rewriting\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"forward\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#forward\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eforward\u003c/h3\u003e\n\u003cp\u003e前向代理作为客户端的代理，将从互联网上获取的资源返回给一个或多个的客户端，服务端（如Web服务器）只知道代理的IP地址而不知道客户端的IP地址\nForward proxies ensure that websites never communicate directly with a user\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/2021-05-03-22-38-13.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"reverse\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#reverse\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ereverse\u003c/h3\u003e\n\u003cp\u003e反向代理是作为服务器端（如Web服务器）的代理使用，而不是客户端。反向代理是供很多客户端都通过它间接访问不同后端服务器上的资源，而不需要知道这些后端服务器的存在，而以为所有资源都来自于这个反向代理服务器。\nreverse proxies ensure that users would not communicate directly with a back-end server.\n\u003cimg src=\"/assets/images/2021-05-03-22-39-21.png\"\u003e\u003c/p\u003e\n\u003cp\u003eA reverse proxy server is a type of proxy server that typically sits behind the firewall in a private network and directs client requests to the appropriate backend server. A reverse proxy provides an additional level of abstraction and control to ensure the smooth flow of network traffic between clients and servers.\u003c/p\u003e\n\u003ch2 id=\"dns\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#dns\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eDNS\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eround-robin DNS: multiple IP addresses are associated with a single domain name\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Load_balancing_(computing)#DNS_delegation\"\u003eDNS delegation\u003c/a\u003e: delegate \u003ca href=\"http://www.example.org\"\u003ewww.example.org\u003c/a\u003e as a sub-domain whose zone is served by each of the same servers that are serving the web site. This technique works particularly well where individual servers are spread geographically on the Internet. \u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"0f1b48c7-3a25-4016-83a5-15864d7803ad","title":"Development","vault":{"fsPath":"repos/dendron-aws-vault","remote":{"type":"git","url":"https://github.com/cczhong11/my_note.git"},"name":"my_note"},"type":"note","desc":"","links":[{"from":{"fname":"root","vaultName":"my_note"},"type":"backlink","position":{"start":{"line":8,"column":3,"offset":63},"end":{"line":8,"column":21,"offset":81},"indent":[]},"value":"development","alias":"开发"}],"anchors":{},"fname":"development","updated":1618381238346,"created":1612940782409,"parent":null,"children":["400115e9-30f7-4a13-9776-db059bc9cd42","xsX5v3ZsyJ0i6gf9","1bc3b45a-b6f4-4150-87d3-5bd5b6eb8c24","6cea4852-6e7c-4140-b476-85c07b48a642","a40ef849-d301-4d74-a778-e6d9469dfb5d","09d9081f-3dff-453d-8488-7d2344cc8895","92917ea3-452e-48dc-875e-5cd0002041db","2e151826-cb22-4d89-8ce0-71dad7204ce8","baa39444-0da9-4c55-8df7-2a6f8f787fa4","62daf50d-a39e-463f-aabd-be53790281fd","3524d0a7-be73-45d6-847e-c970f5c1c760","eac0f243-05b3-4b95-bec3-848e33edbc40","ocei7tftc6l4ea0165ee8rx"],"data":{},"custom":{"nav_order":0,"permalink":"/"},"body":"\n","contentHash":"38357962f5a50c6fd7d318dfa66bea90"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"previewV2Enabled":false,"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{}},"workspace":{"dendronVersion":"0.90.0","vaults":[{"fsPath":"repos/dendron-aws-vault","remote":{"type":"git","url":"https://github.com/cczhong11/my_note.git"},"name":"my_note"},{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableUserTags":true,"enableHashTags":true,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["development","life"],"enableSiteLastModified":true,"siteRootDir":"docs","siteUrl":"https://notes.tczhong.com","enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"writeStubs":false,"seo":{"title":"my_note","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enablePrettyLinks":true,"siteFaviconPath":"favicon.ico","siteIndex":"development"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"f5ca7595-879b-46b9-966a-5952a292fdfc"},"buildId":"BJJu79SH0O6jPLyBmlOdc","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>